# PureProxy çº¯å‡€åº¦æ‰«æ (å…¨æ ˆç‰ˆ)

è¿™æ˜¯ä¸€ä¸ªåŸºäº **Cloudflare ç”Ÿæ€ç³»ç»Ÿ** æ„å»ºçš„ç°ä»£åŒ–ä»£ç† IP æœç´¢å¼•æ“ã€‚
å®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Cloudflare çš„å…¨å¥—æ— æœåŠ¡å™¨ç»„ä»¶æ„å»ºåº”ç”¨ï¼š
*   **Frontend (å‰ç«¯)**: React + Tailwind CSS (æ‰˜ç®¡åœ¨ Cloudflare Pages)
*   **Backend (åç«¯)**: Cloudflare Workers (å¤„ç† API å’Œå®šæ—¶ä»»åŠ¡)
*   **Database (æ•°æ®åº“)**: Cloudflare D1 (SQLiteï¼Œå­˜å‚¨ç»è¿‡éªŒè¯çš„ IP)
*   **AI**: Google Gemini / OpenAI (æ™ºèƒ½åˆ†æ)

---

## ğŸ› ï¸ éƒ¨ç½²æŒ‡å— (çº¯å›¾å½¢åŒ–ç•Œé¢ç‰ˆ)

æœ¬æŒ‡å—æ—¨åœ¨è®©ä½ **æ— éœ€ä½¿ç”¨ç»ˆç«¯å‘½ä»¤è¡Œ (CLI)**ï¼Œä»…é€šè¿‡æµè§ˆå™¨å³å¯åœ¨ Cloudflare Dashboard ä¸Šå®Œæˆæ‰€æœ‰éƒ¨ç½²ã€‚

### å‡†å¤‡å·¥ä½œ

1.  æ³¨å†Œå¹¶ç™»å½• [Cloudflare Dashboard (Cloudflare æ§åˆ¶å°)](https://dash.cloudflare.com/)ã€‚
2.  ä¸‹è½½æœ¬é¡¹ç›®ä»£ç åˆ°æœ¬åœ°ï¼Œç”¨è®°äº‹æœ¬æˆ–ä»£ç ç¼–è¾‘å™¨æ‰“å¼€å¤‡ç”¨ã€‚

---

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»º D1 æ•°æ®åº“

1.  åœ¨å·¦ä¾§ä¸»èœå•ç‚¹å‡» **Workers & Pages (Workers å’Œ Pages)**ã€‚
2.  åœ¨å·¦ä¾§å­èœå•ä¸­æ‰¾åˆ°å¹¶ç‚¹å‡» **D1 SQL Database (D1 SQL æ•°æ®åº“)**ã€‚
3.  ç‚¹å‡»é¡µé¢ä¸Šçš„ **Create (åˆ›å»º)** æŒ‰é’®ã€‚
4.  åœ¨ **Database name (æ•°æ®åº“åç§°)** è¾“å…¥æ¡†ä¸­å¡«å†™: `pureproxy-db`ã€‚
5.  ç‚¹å‡» **Create (åˆ›å»º)** æŒ‰é’®ã€‚
6.  **åˆå§‹åŒ–è¡¨ç»“æ„ (é‡è¦)**:
    *   åˆ›å»ºæˆåŠŸåï¼Œé¡µé¢ä¼šè‡ªåŠ¨è·³è½¬åˆ° `pureproxy-db` çš„è¯¦æƒ…é¡µã€‚
    *   ç‚¹å‡»é¡¶éƒ¨çš„ **Console (æ§åˆ¶å°)** æ ‡ç­¾é¡µã€‚
    *   **å¤åˆ¶ä»¥ä¸‹ SQL ä»£ç **ï¼Œç²˜è´´åˆ°ç½‘é¡µçš„ SQL è¾“å…¥åŒºåŸŸä¸­ï¼š

    ```sql
    DROP TABLE IF EXISTS proxies;
    CREATE TABLE proxies (
      id TEXT PRIMARY KEY,
      ip TEXT NOT NULL,
      port INTEGER NOT NULL,
      protocol TEXT,
      country TEXT,
      country_code TEXT,
      isp TEXT,
      anonymity TEXT,
      latency INTEGER,
      purity_score INTEGER,
      cf_pass_prob INTEGER,
      last_checked INTEGER,
      created_at INTEGER,
      UNIQUE(ip, port)
    );
    CREATE INDEX idx_proxies_purity ON proxies(purity_score DESC);
    CREATE INDEX idx_proxies_country ON proxies(country_code);
    CREATE INDEX idx_proxies_protocol ON proxies(protocol);
    ```

    *   ç‚¹å‡»å³ä¾§çš„ **Execute (æ‰§è¡Œ)** æŒ‰é’®ã€‚
    *   *ä¸‹æ–¹æ˜¾ç¤ºç»¿è‰² "Success" æç¤ºå³è¡¨ç¤ºæ•°æ®åº“è¡¨å·²å»ºç«‹ã€‚*

---

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºå¹¶éƒ¨ç½²åç«¯ Worker

æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª Worker æ¥è¿è¡Œåç«¯é€»è¾‘ï¼Œå¹¶å°†å…¶ç»‘å®šåˆ°åˆšæ‰åˆ›å»ºçš„æ•°æ®åº“ã€‚

#### 1. åˆ›å»º Worker
1.  å›åˆ° **Workers & Pages (Workers å’Œ Pages)** -> **Overview (æ¦‚è§ˆ)**ã€‚
2.  ç‚¹å‡» **Create application (åˆ›å»ºåº”ç”¨)**ã€‚
3.  ç‚¹å‡» **Create Worker (åˆ›å»º Worker)** æŒ‰é’®ã€‚
4.  åœ¨ **Name (åç§°)** è¾“å…¥æ¡†ä¸­å¡«å†™: `pureproxy-backend`ã€‚
5.  ç‚¹å‡»åº•éƒ¨çš„ **Deploy (éƒ¨ç½²)** æŒ‰é’® (è¿™å°†éƒ¨ç½²ä¸€ä¸ªé»˜è®¤çš„ Hello World ä»£ç ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬é©¬ä¸Šä¼šè¦†ç›–å®ƒ)ã€‚

#### 2. ä¸Šä¼ åç«¯ä»£ç 
1.  éƒ¨ç½²å®Œæˆåï¼Œç‚¹å‡»é¡µé¢é¡¶éƒ¨çš„ **Edit code (ç¼–è¾‘ä»£ç )** æŒ‰é’®ï¼Œè¿›å…¥åœ¨çº¿ä»£ç ç¼–è¾‘å™¨ã€‚
2.  åœ¨å·¦ä¾§æ–‡ä»¶åˆ—è¡¨åŒºåŸŸï¼Œç¡®ä¿åªæœ‰ä¸€ä¸ª `worker.js` (æˆ–è€…æ˜¯ `index.js`)ã€‚
3.  æ‰“å¼€ä½ æœ¬åœ°é¡¹ç›®ä¸­çš„ `worker/index.ts` æ–‡ä»¶ï¼Œ**å…¨é€‰å¹¶å¤åˆ¶**æ‰€æœ‰å†…å®¹ã€‚
    *   *æ³¨æ„ï¼šä»£ç å·²ç»ä¼˜åŒ–ä¸ºçº¯ JavaScriptï¼Œå¯ä»¥ç›´æ¥ç²˜è´´ä½¿ç”¨ï¼Œä¸ä¼šæŠ¥é”™ã€‚*
4.  å›åˆ°åœ¨çº¿ç¼–è¾‘å™¨ï¼Œ**æ¸…ç©º** ç¼–è¾‘å™¨ä¸­åŸæœ‰çš„ä»£ç ï¼Œå°†ä½ å¤åˆ¶çš„å†…å®¹ **ç²˜è´´** è¿›å»ã€‚
5.  ç‚¹å‡»ç¼–è¾‘å™¨å³ä¸Šè§’çš„ **Deploy (éƒ¨ç½²)** æŒ‰é’®ã€‚

#### 3. ç»‘å®šæ•°æ®åº“ (å…³é”®æ­¥éª¤)
1.  ç‚¹å‡»ç¼–è¾‘å™¨å·¦ä¸Šè§’çš„ `pureproxy-backend` è¿”å› Worker è¯¦æƒ…é¡µï¼ˆæˆ–è€…ç‚¹å‡»é¡¶éƒ¨ **Settings**ï¼‰ã€‚
2.  ç‚¹å‡» **Settings (è®¾ç½®)** æ ‡ç­¾é¡µã€‚
3.  åœ¨äºŒçº§èœå•ç‚¹å‡» **Bindings (ç»‘å®š)**ã€‚
4.  ç‚¹å‡» **Add (æ·»åŠ )** æŒ‰é’®ï¼Œåœ¨ä¸‹æ‹‰èœå•ä¸­é€‰æ‹© **D1 Database (D1 æ•°æ®åº“)**ã€‚
5.  é…ç½®ç»‘å®šä¿¡æ¯ï¼š
    *   **Variable name (å˜é‡åç§°)**: è¾“å…¥ `DB` (âš ï¸ å¿…é¡»å®Œå…¨ä¸€è‡´ï¼Œå› ä¸ºä»£ç ä¸­ä½¿ç”¨ `env.DB` è°ƒç”¨)ã€‚
    *   **D1 database (D1 æ•°æ®åº“)**: åœ¨ä¸‹æ‹‰æ¡†ä¸­é€‰æ‹©ç¬¬ä¸€æ­¥åˆ›å»ºçš„ `pureproxy-db`ã€‚
6.  ç‚¹å‡»å³ä¾§çš„ **Deploy (éƒ¨ç½²)** æŒ‰é’®ä¿å­˜è®¾ç½®ã€‚

#### 4. è®¾ç½®å®šæ—¶ä»»åŠ¡ (Cron Triggers)
ä¸ºäº†è®©çˆ¬è™«è‡ªåŠ¨è¿è¡Œï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®è§¦å‘å™¨ã€‚

1.  ä»åœ¨ **Settings (è®¾ç½®)** é¡µé¢ã€‚
2.  åœ¨äºŒçº§èœå•ç‚¹å‡» **Triggers (è§¦å‘å™¨)**ã€‚
3.  æ‰¾åˆ° **Cron Triggers (Cron è§¦å‘å™¨)** éƒ¨åˆ†ï¼Œç‚¹å‡» **Add Cron Trigger (æ·»åŠ  Cron è§¦å‘å™¨)**ã€‚
4.  åœ¨ **Cron schedule (Cron è®¡åˆ’)** ä¸­è¾“å…¥: `*/30 * * * *` (æ„æ€æ˜¯æ¯ 30 åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡)ã€‚
5.  ç‚¹å‡» **Add Trigger (æ·»åŠ è§¦å‘å™¨)**ã€‚

#### 5. è·å–åç«¯ API åœ°å€
1.  åœ¨ Worker è¯¦æƒ…é¡µçš„é¡¶éƒ¨ï¼Œä½ ä¼šçœ‹åˆ° **Preview URL (é¢„è§ˆ URL)** (æ ¼å¼é€šå¸¸æ˜¯ `https://pureproxy-backend.ä½ çš„ç”¨æˆ·å.workers.dev`)ã€‚
2.  âš ï¸ **è¯·å¤åˆ¶è¿™ä¸ª URL**ï¼Œè¿™æ˜¯ä½ çš„åç«¯ API åœ°å€ï¼Œä¸‹ä¸€æ­¥å‰ç«¯éƒ¨ç½²ä¼šç”¨åˆ°ã€‚

---

### ç¬¬ä¸‰æ­¥ï¼šéƒ¨ç½²å‰ç«¯ (Cloudflare Pages)

å‰ç«¯æ¨èè¿æ¥ GitHub è‡ªåŠ¨éƒ¨ç½²ï¼Œè¿™æ ·æœ€çœå¿ƒã€‚

#### 1. å‡†å¤‡ä»£ç ä»“åº“
1.  å°†æœ¬é¡¹ç›®çš„æ‰€æœ‰ä»£ç ä¸Šä¼ åˆ°ä½ è‡ªå·±çš„ GitHub ä»“åº“ä¸­ã€‚

#### 2. åˆ›å»º Pages é¡¹ç›®
1.  å›åˆ° Cloudflare Dashboard çš„ **Workers & Pages (Workers å’Œ Pages)**ã€‚
2.  ç‚¹å‡» **Create application (åˆ›å»ºåº”ç”¨)**ã€‚
3.  ç‚¹å‡»é¡¶éƒ¨çš„ **Pages** æ ‡ç­¾é¡µã€‚
4.  ç‚¹å‡» **Connect to Git (è¿æ¥ Git)** æŒ‰é’®ã€‚
5.  é€‰æ‹©ä½ åˆšæ‰ä¸Šä¼ çš„ GitHub ä»“åº“ï¼Œç‚¹å‡» **Begin setup (å¼€å§‹è®¾ç½®)**ã€‚

#### 3. æ„å»ºé…ç½® (Build Settings)
åœ¨é…ç½®é¡µé¢å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼š
*   **Project name (é¡¹ç›®åç§°)**: `pureproxy-web`
*   **Framework preset (æ¡†æ¶é¢„è®¾)**: åœ¨ä¸‹æ‹‰èœå•é€‰æ‹© `Create React App`ã€‚
*   **Build command (æ„å»ºå‘½ä»¤)**: ä¿æŒé»˜è®¤ `npm run build`ã€‚
*   **Output directory (è¾“å‡ºç›®å½•)**: ä¿æŒé»˜è®¤ `build`ã€‚

#### 4. é…ç½®ç¯å¢ƒå˜é‡ (è¿æ¥åç«¯)
æˆ‘ä»¬éœ€è¦å‘Šè¯‰å‰ç«¯å»å“ªé‡Œè·å–æ•°æ®ã€‚

1.  åœ¨åŒä¸€é¡µé¢ï¼Œç‚¹å‡» **Environment variables (ç¯å¢ƒå˜é‡)** å±•å¼€è®¾ç½®åŒºåŸŸã€‚
2.  ç‚¹å‡» **Add variable (æ·»åŠ å˜é‡)**ã€‚
3.  æ·»åŠ åç«¯åœ°å€å˜é‡ï¼š
    *   **Variable name**: `REACT_APP_API_URL`
    *   **Value**: ç²˜è´´ä½ åœ¨ç¬¬äºŒæ­¥æœ€åå¤åˆ¶çš„åç«¯ URL (ä¾‹å¦‚ `https://pureproxy-backend.xxxx.workers.dev`)ã€‚
4.  *(å¯é€‰) æ·»åŠ  AI Key*:
    *   å¦‚æœä½ æƒ³ä½¿ç”¨ AI åŠŸèƒ½ï¼Œå†æ·»åŠ ä¸€ä¸ªå˜é‡ã€‚
    *   **Variable name**: `GEMINI_API_KEY` (æˆ–è€… `OPENAI_API_KEY` ç­‰)ã€‚
    *   **Value**: ä½ çš„ API Keyã€‚

#### 5. å®Œæˆéƒ¨ç½²
1.  ç‚¹å‡»åº•éƒ¨çš„ **Save and Deploy (ä¿å­˜å¹¶éƒ¨ç½²)**ã€‚

---

### ğŸ‰ éªŒè¯ä¸ä½¿ç”¨

1.  ç­‰å¾… Pages æ„å»ºå®Œæˆï¼ˆçº¦ 1-2 åˆ†é’Ÿï¼‰ï¼Œç‚¹å‡» Cloudflare æä¾›çš„ **Pages URL** è®¿é—®ç½‘ç«™ã€‚
2.  **é¦–æ¬¡æ•°æ®å¡«å……**:
    *   åˆšéƒ¨ç½²å®Œæ•°æ®åº“æ˜¯ç©ºçš„ï¼Œåˆ—è¡¨ä¼šæ˜¾ç¤ºä¸ºç©ºã€‚
    *   ä½ å¯ä»¥å›åˆ° Worker (`pureproxy-backend`) çš„ **Settings (è®¾ç½®)** -> **Triggers (è§¦å‘å™¨)** -> **Cron Triggers** éƒ¨åˆ†ã€‚
    *   ç‚¹å‡»å³ä¾§çš„ **Test (æµ‹è¯•)** æŒ‰é’®ï¼Œè¿™ä¼šç«‹å³è§¦å‘ä¸€æ¬¡çˆ¬è™«è¿è¡Œã€‚
    *   ç­‰å¾…å‡ ç§’é’Ÿï¼Œåˆ·æ–°ä½ çš„å‰ç«¯ç½‘é¡µï¼Œå³å¯çœ‹åˆ°æŠ“å–åˆ°çš„çœŸå®ä»£ç† IPï¼

---

## æŠ€æœ¯æ ˆ

*   **Runtime**: Cloudflare Workers
*   **Database**: Cloudflare D1
*   **Frontend**: React 18 + Tailwind CSS
*   **AI**: Google GenAI SDK / Fetch API